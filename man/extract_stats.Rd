% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extract_stats.R
\name{extract_stats}
\alias{extract_stats}
\title{Extract Statistical Information for Bayes Factor Computation}
\usage{
extract_stats(standard_scores, measurement_values, subject_ids = NULL)
}
\arguments{
\item{standard_scores}{A numeric (typically binary 0/1) vector representing the
standard or outcome scores.}

\item{measurement_values}{A numeric vector of measurement values to be correlated
with \code{standard_scores}.}

\item{subject_ids}{(Optional) A vector of subject identifiers. If provided, the
correlation is computed within subjects by partialling out subject effects
(equivalent to including subject fixed effects in a regression model).}
}
\value{
A list containing:
\describe{
\item{t_statistic}{The t-statistic corresponding to the (partial) correlation
between \code{measurement_values} and \code{standard_scores}. This statistic is
directly compatible with Eq. 5 for Bayes factor computation.}
\item{sum_squares}{The sum of squares of \code{measurement_values} at the appropriate
level (within-subject if repeated, across all data if unpaired), used for weighting.}
\item{sample_size}{An effective sample size such that \code{sample_size - 2}
equals the residual degrees of freedom associated with the t-statistic.}
}
}
\description{
This function extracts the key statistics needed for computing a correlation-based
Bayes factor (Eq. 5). It computes the Pearson correlation between \code{measurement_values}
and \code{standard_scores}, and converts it to a t-statistic. When \code{subject_ids} are provided,
it computes the \strong{within-subject partial correlation} (i.e., the correlation of
subject-centered residuals) to account for repeated or paired measurements.
}
\details{
\itemize{
\item If \code{subject_ids} is \strong{not provided}, the function computes a standard Pearson correlation
and converts it to a t-statistic using \eqn{t = r\sqrt{(n-2)/(1-r^2)}} with \eqn{df = n-2}.
\item If \code{subject_ids} is \strong{provided}, both variables are centered within each subject,
yielding a within-subject (partial) correlation. The corresponding t-statistic is computed
using \eqn{df = N - S - 1}, where \eqn{N} is the number of rows and \eqn{S} is the number
of unique subjects. This t is identical to that from \code{lm(measurement ~ score + subject)}.
}

The resulting \code{t_statistic} and \code{sample_size} are suitable for direct use in
\code{tstat2bf()} and then \code{meta_bf_from_data()}.
}
\examples{
# Example 1: Unpaired design (between subjects)
df1 <- data.frame(
  subject = paste0("S", 1:4),
  score = c(0, 0, 1, 1),
  measurement = c(1.0, 0.6, 1.9, 1.5)
)
extract_stats(df1$score, df1$measurement)

# Example 2: Paired / repeated design (within subjects)
df2 <- data.frame(
  subject = c("A","A","B","B","C","C"),
  score = c(0,1,0,1,0,1),
  measurement = c(1.2,1.8,0.7,1.1,2.0,2.4)
)
extract_stats(df2$score, df2$measurement, df2$subject)

}
\seealso{
\code{\link{tstat2bf}}, \code{\link{meta_bf_from_data}}
}
